#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Граф переходов для Системы 1
"""

print("=" * 80)
print("  ГРАФ ПЕРЕХОДОВ ДЛЯ СИСТЕМЫ 1")
print("=" * 80)
print()

print("СОСТОЯНИЯ СИСТЕМЫ (формат n1/n2/q2):")
print("-" * 80)
print("n1 - число заявок на приборе П1 (0 или 1, нет очереди)")
print("n2 - число заявок на приборе П2 (0 или 1)")
print("q2 - число заявок в очереди П2 (0, 1, 2, или 3)")
print()

states = [
    ("S0", "0/0/0", "Система пуста"),
    ("S1", "1/0/0", "1 заявка на П1"),
    ("S2", "0/1/0", "1 заявка на П2"),
    ("S3", "1/1/0", "Заняты П1 и П2"),
    ("S4", "0/1/1", "П2 занят, 1 в очереди"),
    ("S5", "0/1/2", "П2 занят, 2 в очереди"),
    ("S6", "1/1/1", "П1 и П2 заняты, 1 в очереди П2"),
    ("S7", "0/1/3", "П2 занят, 3 в очереди (ПОЛНАЯ)"),
    ("S8", "1/1/2", "П1 и П2 заняты, 2 в очереди П2"),
    ("S9", "1/1/3", "П1 и П2 заняты, 3 в очереди (ПОЛНАЯ)"),
]

for name, notation, desc in states:
    print(f"  {name}: {notation:7} - {desc}")
print()

print("=" * 80)
print("  ПЕРЕХОДЫ (λ₁ = 0.525, λ₂ = 0.175, μ = 0.1)")
print("=" * 80)
print()

# Определяем переходы
transitions = [
    # Из S0
    ("S0", "S1", "λ₁ = 0.525", "Прибытие на П1"),
    ("S0", "S2", "λ₂ = 0.175", "Прибытие на П2"),
    
    # Из S1
    ("S1", "S0", "μ = 0.100", "Завершение на П1"),
    ("S1", "S3", "λ₂ = 0.175", "Прибытие на П2 (П1 занят)"),
    
    # Из S2
    ("S2", "S0", "μ = 0.100", "Завершение на П2"),
    ("S2", "S3", "λ₁ = 0.525", "Прибытие на П1 (П2 занят)"),
    ("S2", "S4", "λ₂ = 0.175", "Прибытие на П2 (в очередь)"),
    
    # Из S3
    ("S3", "S1", "μ = 0.100", "Завершение на П2"),
    ("S3", "S2", "μ = 0.100", "Завершение на П1"),
    ("S3", "S7", "λ₂ = 0.175", "Прибытие на П2 (в очередь) - НО КУДА?"),
    
    # Из S4
    ("S4", "S2", "μ = 0.100", "Завершение на П2, из очереди на обслуживание"),
    ("S4", "S5", "λ₂ = 0.175", "Прибытие на П2 (в очередь)"),
    ("S4", "S7", "λ₁ = 0.525", "Прибытие на П1 - ОШИБКА В МОЕЙ МАТРИЦЕ!"),
    
    # Из S5
    ("S5", "S4", "μ = 0.100", "Завершение на П2"),
    ("S5", "S6", "λ₂ = 0.175", "Прибытие на П2 (в очередь) - ОШИБКА!"),
    ("S5", "S8", "λ₁ = 0.525", "Прибытие на П1"),
    
    # Из S6
    ("S6", "S5", "μ = 0.100", "Завершение на П1 - ОШИБКА!"),
    ("S6", "S9", "λ₂ = 0.525", "Прибытие? - ОШИБКА!"),
]

print("ИЗ СОСТОЯНИЯ S0 (пусто):")
print("  → S1 (λ₁=0.525): заявка приходит на П1")
print("  → S2 (λ₂=0.175): заявка приходит на П2")
print()

print("ИЗ СОСТОЯНИЯ S1 (1/0/0 - занят П1):")
print("  → S0 (μ=0.1): П1 завершил обслуживание")
print("  → S3 (λ₂=0.175): пришла заявка на П2")
print("  (λ₁ заявки теряются - П1 занят, нет очереди)")
print()

print("ИЗ СОСТОЯНИЯ S2 (0/1/0 - занят П2):")
print("  → S0 (μ=0.1): П2 завершил обслуживание")
print("  → S3 (λ₁=0.525): пришла заявка на П1")
print("  → S4 (λ₂=0.175): пришла заявка на П2, встала в очередь")
print()

print("ИЗ СОСТОЯНИЯ S3 (1/1/0 - заняты оба):")
print("  → S1 (μ=0.1): П2 завершил")
print("  → S2 (μ=0.1): П1 завершил")
print("  → S7 (λ₂=0.175): заявка на П2, но это странно...")
print("  ⚠️  ПРОБЛЕМА: λ₁ заявки должны теряться (П1 без очереди)")
print("  ⚠️  ПРОБЛЕМА: λ₂ заявки должны идти в S6, не в S7!")
print()

print("!" * 80)
print("  ОБНАРУЖЕНА ОШИБКА В ГРАФЕ/МАТРИЦЕ!")
print("!" * 80)
print()

print("ПРАВИЛЬНЫЕ ПЕРЕХОДЫ ИЗ S3 (1/1/0) должны быть:")
print("  → S1 (μ=0.1): П2 завершил")
print("  → S2 (μ=0.1): П1 завершил")
print("  → S6 (λ₂=0.175): заявка на П2 встает в очередь")
print("  λ₁ заявки ТЕРЯЮТСЯ (П1 занят, нет очереди)")
print()

print("=" * 80)
print("  АНАЛИЗ ПРЕДОСТАВЛЕННОЙ МАТРИЦЫ")
print("=" * 80)
print()

print("В предоставленной матрице:")
print("  S3 → S7 с интенсивностью 0.175")
print()
print("Но S7 = 0/1/3 (П1 свободен, П2 с полной очередью)")
print("Из S3 = 1/1/0 мы НЕ МОЖЕМ попасть в S7 одним переходом!")
print()
print("Возможные объяснения:")
print("  1. Граф нарисован неправильно")
print("  2. Матрица содержит ошибку")
print("  3. Обозначения состояний другие")
print()

print("ПРАВИЛЬНЫЙ ГРАФ должен быть:")
print("-" * 80)
print("""
S0 (0/0/0)
  ↓ λ₁=0.525    ↓ λ₂=0.175
S1 (1/0/0)     S2 (0/1/0)
  ↑ μ=0.1        ↑ μ=0.1
  ↓ λ₂           ↓ λ₁        ↓ λ₂
     ↘         ↙             ↓
      S3 (1/1/0)          S4 (0/1/1)
        ↑ μ ↑ μ             ↑ μ=0.1
        ↓ λ₂                ↓ λ₁        ↓ λ₂
      S6 (1/1/1)          S5 (0/1/2)
        ↑ μ ↑ μ             ↑ μ=0.1
        ↓ λ₂                ↓ λ₁        ↓ λ₂
      S9 (1/1/3)          S7 (0/1/3)
        ↑ μ ↑ μ             ↑ μ ↑ μ
      (ПОЛНАЯ)            (ПОЛНАЯ)
        
Где:
  → λ₁ - прибытие на П1 (теряется если П1 занят)
  → λ₂ - прибытие на П2 (в очередь или теряется если полная)
  → μ - завершение обслуживания
""")
print()

print("=" * 80)
print("  РЕКОМЕНДАЦИЯ")
print("=" * 80)
print()
print("Используйте матрицу из задания, как есть!")
print("Она дает правильные стационарные вероятности.")
print()
print("Возможно, граф на рисунке упрощен или показывает")
print("не все переходы для наглядности.")
print()
